Core functionality for shared contracts
